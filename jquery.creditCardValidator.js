(function(){var $,n=[].indexOf||function(n){for(var t=0,e=this.length;e>t;t++)if(t in this&&this[t]===n)return t;return-1};$=jQuery,$.fn.validateCreditCard=function(t,e){var r,a,l,i,u,c,h,v,o,s,d,f;for(l=[{name:"amex",pattern:/^3[47]/,valid_length:[15]},{name:"diners_club_carte_blanche",pattern:/^30[0-5]/,valid_length:[14]},{name:"diners_club_international",pattern:/^36/,valid_length:[14]},{name:"jcb",pattern:/^35(2[89]|[3-8][0-9])/,valid_length:[16]},{name:"laser",pattern:/^(6304|670[69]|6771)/,valid_length:[16,17,18,19]},{name:"visa_electron",pattern:/^(4026|417500|4508|4844|491(3|7))/,valid_length:[16]},{name:"visa",pattern:/^4/,valid_length:[16]},{name:"mastercard",pattern:/^5[1-5]/,valid_length:[16]},{name:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,valid_length:[12,13,14,15,16,17,18,19]},{name:"discover",pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,valid_length:[16]}],null==e&&(e={}),null==e.accept&&(e.accept=function(){var n,t,e;for(e=[],n=0,t=l.length;t>n;n++)r=l[n],e.push(r.name);return e}()),f=e.accept,s=0,d=f.length;d>s;s++)if(a=f[s],n.call(function(){var n,t,e;for(e=[],n=0,t=l.length;t>n;n++)r=l[n],e.push(r.name);return e}(),a)<0)throw"Credit card type '"+a+"' is not supported";return i=function(t){var i,u,c;for(c=function(){var t,a,i,u;for(u=[],t=0,a=l.length;a>t;t++)r=l[t],i=r.name,n.call(e.accept,i)>=0&&u.push(r);return u}(),i=0,u=c.length;u>i;i++)if(a=c[i],t.match(a.pattern))return a;return null},c=function(n){var t,e,r,a,l,i;for(r=0,i=n.split("").reverse(),e=a=0,l=i.length;l>a;e=++a)t=i[e],t=+t,e%2?(t*=2,r+=10>t?t:t-9):r+=t;return r%10===0},u=function(t,e){var r;return r=t.length,n.call(e.valid_length,r)>=0},o=function(n){return function(e){var r,l;return a=i(e),l=!1,r=!1,null!=a&&(l=c(e),r=u(e,a)),t.call(n,{card_type:a,luhn_valid:l,length_valid:r})}}(this),v=function(){var n;return n=h($(this).val()),o(n)},h=function(n){return n.replace(/[ -]/g,"")},this.bind("input",function(){return $(this).unbind("keyup"),v.call(this)}),this.bind("keyup",function(){return v.call(this)}),0!==this.length&&v.call(this),this}}).call(this);